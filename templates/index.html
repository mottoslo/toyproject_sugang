<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <link rel="stylesheet" href="../static/css/login.css">
    <title>로그인 페이지</title>

    <script>
        function login() {
            $.ajax({
                    type: "POST",
                    url: "/api/login",
                    data: {id_give: $('#user_id').val(), pw_give: $('#user_pw').val()},
                    success: function (response) {
                        if (response['result'] == 'success') {
                            // 로그인이 정상적으로 되면, 토큰을 받아옵니다.
                            // 이 토큰을 mytoken이라는 키 값으로 쿠키에 저장합니다.
                            $.cookie('user_token', response['token']);

                            alert('로그인 완료!')
                            window.location.href = '/'
                        } else {
                            // 로그인이 안되면 에러메시지를 띄웁니다.
                            alert(response['msg'])
                        }
                    }
                })
            // let user_id = $('#user_id').val()
            // let user_pw = $('#user_pw').val()

            //     let formData = new FormData();
            //     formData.append("user_id_give", user_id);
            //     formData.append("user_pw_give", user_pw);

                // fetch('/api/login', { method: "POST", body: formData }).then((response) => response.json()).then((data) => {
                //     if (data['result'] == 1) {
                //         // console.log(data)
                //         alert('즐거운 항해되세요')
                //         window.location.href = '/classes'
                //     }
                //     else {
                //         alert('ID/PW를 확인해주세요.')
                //         window.location.reload()
                //     }
                // });
        }
    </script>
</head>

<body>
    <!-- 로그인페이지 만들고, 로그인 성공 시 classlist페이지로 넘겨주기 -->
    <article>
        <div class="login_wrapper">

            <div class="login_logo">항해99</div>
            <div>
                <input id="user_id" class="login_text" type="text" name="id" placeholder="아이디">
                <input id="user_pw" class="login_text" type="password" name="id" placeholder="비밀번호" required>

                <div>
                    <button onclick="login()" id="login_btn" class="login_btn" type="button">로그인</button>
                    <a class="login_bottom" href="register">회원가입</a>
                </div>
            </div>
        </div>
    </article>
</body>

</html>